<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>  TypeScript strictness is non-monotonic: strict-null-checks and no-implicit-any interact |  Huon on the internet</title>

  <link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Atom feed">
  <link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="RSS feed">
  
  <link rel="canonical" href="https://huonw.github.io/blog/2025/12/typescript-monotonic/">

  <meta name="viewport" content="width=device-width; initial-scale=1.0;" />
  

  
  <meta name="description" content="A curiosity about the interaction between two TypeScript compiler settings, that lead to errors that appear and disappear, as one increases strictness." />

  
  <meta name="twitter:card" content="summary" />
  
  <meta name="twitter:site" content="@huon_w" />
  <meta name="twitter:title" content="TypeScript strictness is non-monotonic: strict-null-checks and no-implicit-any interact" />
  <meta name="twitter:description" content="A curiosity about the interaction between two TypeScript compiler settings, that lead to errors that appear and disappear, as one increases strictness." />
  <meta name="twitter:url" content="https://huonw.github.io/blog/2025/12/typescript-monotonic/">

  <!-- facebook -->
  <meta property="og:url" content="https://huonw.github.io/blog/2025/12/typescript-monotonic/" />
  <meta property="og:title" content="TypeScript strictness is non-monotonic: strict-null-checks and no-implicit-any interact" />
  <meta property="og:description" content="A curiosity about the interaction between two TypeScript compiler settings, that lead to errors that appear and disappear, as one increases strictness." />
  
  <meta property="og:type" content="article" />
  
  
  
  <style>
    /*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */
*,::after,::before{box-sizing:border-box}html{line-height:1.15;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4}body{margin:0;font-family:system-ui, -apple-system,'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji'}hr{height:0;color:inherit}abbr[title]{text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Consolas, 'Liberation Mono', Menlo, monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}table{text-indent:0;border-color:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type='button'],[type='reset'],[type='submit'],button{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}legend{padding:0}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type='search']{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}


    
      /* Borrowed from mojombo: https://github.com/mojombo/mojombo.github.com/blob/master/css/syntax.css */

.lineno { width: 2em; text-align:right; }
.highlight pre {
  white-space: pre;
}
.highlight .c { color: #777; font-style: italic; } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { font-weight: bold } /* Keyword */
.highlight .o { font-weight: bold } /* Operator */
.highlight .cm { color: #999988; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #999999; font-weight: bold } /* Comment.Preproc */
.highlight .c1 { color: #999988; font-style: italic } /* Comment.Single */
.highlight .cs { color: #999999; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .gd .x { color: #000000; background-color: #ffaaaa } /* Generic.Deleted.Specific */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #999999 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .gi .x { color: #000000; background-color: #aaffaa } /* Generic.Inserted.Specific */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #aaaaaa } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { font-weight: bold } /* Keyword.Constant */
.highlight .kd { font-weight: bold } /* Keyword.Declaration */
.highlight .kp { font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #445588; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #009999 } /* Literal.Number */
.highlight .s { color: #d14 } /* Literal.String */
.highlight .na { color: #008080 } /* Name.Attribute */
.highlight .nb { color: #0086B3 } /* Name.Builtin */
.highlight .nc { color: #445588; font-weight: bold } /* Name.Class */
.highlight .no { color: #008080 } /* Name.Constant */
.highlight .ni { color: #800080 } /* Name.Entity */
.highlight .ne { color: #990000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #990000; font-weight: bold } /* Name.Function */
.highlight .nn { color: #555555 } /* Name.Namespace */
.highlight .nt { color: #000080 } /* Name.Tag */
.highlight .nv { color: #008080 } /* Name.Variable */
.highlight .ow { font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #009999 } /* Literal.Number.Float */
.highlight .mh { color: #009999 } /* Literal.Number.Hex */
.highlight .mi { color: #009999 } /* Literal.Number.Integer */
.highlight .mo { color: #009999 } /* Literal.Number.Oct */
.highlight .sb { color: #d14 } /* Literal.String.Backtick */
.highlight .sc { color: #d14 } /* Literal.String.Char */
.highlight .sd { color: #d14 } /* Literal.String.Doc */
.highlight .s2 { color: #d14 } /* Literal.String.Double */
.highlight .se { color: #d14 } /* Literal.String.Escape */
.highlight .sh { color: #d14 } /* Literal.String.Heredoc */
.highlight .si { color: #d14 } /* Literal.String.Interpol */
.highlight .sx { color: #d14 } /* Literal.String.Other */
.highlight .sr { color: #009926 } /* Literal.String.Regex */
.highlight .s1 { color: #d14 } /* Literal.String.Single */
.highlight .ss { color: #990073 } /* Literal.String.Symbol */
.highlight .bp { color: #999999 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #008080 } /* Name.Variable.Class */
.highlight .vg { color: #008080 } /* Name.Variable.Global */
.highlight .vi { color: #008080 } /* Name.Variable.Instance */
.highlight .il { color: #009999 } /* Literal.Number.Integer.Long */


html {
    min-height:100%;
}

* {
  margin: 0;
}
* + * {
  margin-top: 0.75em;
}


body {
  padding:0px;
    counter-reset: footnotes;
    counter-reset: figure;
    margin:0px;
    font-size: 18px;
    background: white;
    color: #101010;

    font-variant: common-ligatures;
    -moz-font-feature-settings: "kern" on;
    -webkit-font-feature-settings: "kern" on;
    font-feature-settings: "kern" on;
}

#wrapper {
    margin: 0 auto;
    max-width: 630px;
    padding: 0.75em 15px;
    width: 100%;
    position:relative;
}

#no-ai {
    text-align: center;
    font-size: small;
}

.lazily-filled {
  position: relative;
}
.lazily-filled > * {
  z-index: 0;
}
.lazily-filled::before {
  position: absolute;
  top: 0;
  left: 0;
  content: "";
  width: 100%;
  height: 100%;
  display: block;
  background-color: rgb(229, 236, 246);
  z-index: 1;
}
.lazily-filled::after {
  position: absolute;
  top: 50%;
  left: 50%;
  content: "";
  display: block;
  width: 128px;
  height: 128px;
  margin-left: -64px;
  margin-top: -64px;
  border-radius: 50%;
  border: 12px solid;
  border-color: white transparent;
  animation: spinner 5s linear;
  /* eventually stop animating when it's hidden */
  animation-iteration-count: 10;
  z-index: 2;
}
.lazily-filled::before, .lazily-filled::after {
  opacity: 0;
  transition: all 0.5s ease;
  pointer-events: none;
}
.lazily-filled:empty::before, .lazily-filled:empty::after {
  opacity: 1;
  animation-iteration-count: infinite;
  visibility: visible;
}
@keyframes spinner {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

.plotly-plot * + * {
  margin-top: 0;
}

/* wonky safari */
.plotly text[style*="white-space: pre"] {
  white-space: nowrap !important;
}


/* lists */
li + li {
  margin-top: 0.5em;
}
ul, ol {
  padding-left: 1.5em;
}

table {
  margin-left: auto;
  margin-right: auto;
  border-collapse: collapse;
  text-align: left;
}

/* ensure tables don't make the whole page scroll, NB. requires manual <div class="table-wrapper" markdown="1">...</div> due to https://github.com/gettalong/kramdown/issues/69 */
.table-wrapper {
  overflow-x: auto;
}

td, th {
  padding: 0.1em 0.75em;
}
@media (max-width: 500px) {
  td, th {
    padding-left: 0.375em;
    padding-right: 0.375em;
  }
}
tr:nth-child(even) {
  background: rgba(0, 0, 0, 5%);
}
thead {
  border-bottom: 1px solid grey;
  font-weight: bold;
}

header {
  margin-bottom: 1.5em;
}
header a:not(:hover) {
  text-decoration: none;
}
#blog-title {
  hyphens: none;
  font-variant: small-caps;
  font-size: 1.5em;
  font-weight: normal;
  text-align: center;
  line-height: 1em;
}
#info-list {
  list-style: none;
  padding: 0;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 0.5em 2em;
}
#info-list li {
  margin: 0;
}

#page-footer {
  border-top: 1px solid lightgrey;
  padding-top: 0.75em;
  color: grey;
  text-align: right;
}

.clear { clear: both; margin: 0; }


main {
    line-height: 1.5em;

    position: relative;
    z-index: 10;
}

a[href] {
    color: inherit;
    text-decoration: underline;
}

/*  The authorship info */
#info-intro {
    font-style: italic;
    text-align: center;
}

/* code */

code, pre {
  font-family: monospace;
  font-variant: none;
  -moz-hyphens: none;
  -webkit-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

pre {
  background: #f0f0f0;
}
code {
    background: #f7f7f7;
    padding: 0 0.1em;
    font-size: 0.9em;
    border-radius: 3px;
    border: 1px solid lightgrey;
}
pre code {
    background: none;
    padding: 0;
    -moz-hyphens: none;
    -webkit-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
    border-radius: 0;
    border-width: 0;
}
h1 code, h2 code, h3 code, h4 code {
  background: rgba(255,255,255,0.1);
}

.break-all {
  word-break: break-all;
}

/* quotes and similar */

blockquote {
    border: solid #eee;
    border-width: 0 1px;
    padding: 0 1.2em;
    color: #444;
    position: relative;
    margin-left: 0;
    margin-right: 0;
}

aside {
  padding: 0 1.2em;
  color: #444;
  position: relative;
}
aside[data-icon] {
  padding-left: 2.4em;
}
aside[data-icon]:before {
  content: attr(data-icon);
  position: absolute;
  left: 0;
  text-align: center;
  width: 2.4em;
}

/* images/figures */
img, figure svg {
  max-width: 100%;
  height: auto;
}
figure svg {
  width: 100%;
}
img:not(.inline-image), figure svg {
    display: block;
    margin: 0 auto;
    clear: both;
}

.image-positioner {
  max-width: 800px;
  margin-left: auto;
  margin-right: auto;
}

img[data-caption]:before {
    content: attr(data-caption);
}
figure {
  clear: both;
}
figure.image {
  width: 100vw;
  position: relative;
  left: 50%;
  right: 50%;
  margin-left: -50vw;
  margin-right: -50vw;

  min-width: 100%;
}
figcaption {
  margin: 0 auto;
  max-width: 570px;
  padding: 0 10px;
  text-align: center;
  font-style: italic;
  font-size: 0.9em;
}
figcaption p {
  display: inline;
}
figcaption::before {
  counter-increment: figure;
  content: "Figure " counter(figure) ". ";
}

.highlight table {
  font-size: 0.9em;
  padding: 0em;
  width: 100%;
  table-layout: fixed;
  overflow-y: hidden;
  display: block;
  position: relative;
  z-index: 1;
}
[data-lang] {
  position: relative;
  display: block;
}
[data-lang]::before {
  content: attr(data-lang);
  text-transform: capitalize;
  top: 0;
  right: 0;
  position: absolute;
  font-size: 1.5em;
  color: #f3f3f3;
  z-index: 1;
}

.highlight pre {
  background: transparent;
}
.gutter {
  padding: 0;
  border: solid #ccc;
  border-width: 0 1px 0 0;
  color: #ccc;
}
.lineno {
  width: 25px;
  padding-right: 5px;
}
/* highlight/endhighlight code blocks */
figure.highlight td.code {
  overflow-x: auto;
  padding: 0;
  padding-left: 0.5em;
}
/* no-highlight/endhighlight code blocks (e.g. in footnotes) */
div.highlight {
  overflow-x: auto;
  padding: 0;
  padding-left: 0.5em;
}


/* HEADINGS */

h1, h2 {
    font-variant: small-caps;
}

h1, h2, h3, h4 {
  -moz-hyphens: none;
  -webkit-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
  text-align: left;
}

h1 {
  font-size: 2.2em;
  text-align: center;
  line-height: 1em;
}
h2 {
  font-size: 1.7em;
}
h3 {
  font-size: 1.4em;
}
h4 {
  font-size: 1.2em;
}

/* crates.io badges */

.lib-info {
  float: right;
  width: 150px;
  text-align: center;
  margin: 0 1em;
}
.lib-badge {
  vertical-align: middle;
}
.centered-libs {
  text-align: center;
}
.centered-libs .lib-info {
  float: none;
}

/* external links */

#external-links {
  margin-top: 2.25em;
  text-align: center;
}
.external-label {
  font-weight: bold;
}
#external-links ul {
  list-style: none;
  display: inline-block;
  padding: 0;
  margin: 0;
}
#external-links li {
  list-style: none;
  display: inline;
}

/* "Footnotes" */

/* the div that holds them */
.footnotes {
    margin-top: 2.25em;
    padding-top: 1.5em;
    border-top: 1px solid rgb(240,240,240);
    font-size: 0.9em;
}
.footnotes ol {
  padding: 0;
}
.footnotes li {
    list-style-position: outside;
    margin-left: 30px;
    margin-right: 10px;
    color: #333;
}

.footnotes li:target, .footnotes li:hover {
    color: black;
    background-color: lightyellow;
}

.footnotes .reversefootnote {
    text-decoration: none;
}

/* extra info after a post */
#more {
  margin-top: 3em;
  padding-top: 1.5em;
  border-top: 1px solid lightgray;
}
#me-icon {
  max-width: 150px;
  height: 150px;
  background: url("/img/me.jpg");
  background-size: cover;
  margin-left: auto;
  margin-right: auto;
  border-radius: 30px;
}
#by-line {
  font-size: 0.8em;
}
#latest-list {
  padding: 0;
  list-style: none;
}
#latest-heading {
  text-align: center;
}
#latest-heading a:not(:hover) {
  text-decoration: none;
}
#latest-list a:hover h3 {
  text-decoration: underline;
}
#latest-list a {
  text-decoration: none;
}
.latest-post {
  padding: 0;
  font-size: 0.8em;
}
.latest-post > h3 {
  font-weight: bold;
}
.latest-post * {
  margin: 0;
}

/* post series */

.post-series {
  font-size: 0.8em;
  border: 1px solid lightgray;
  padding: 0.2em;
  cursor: pointer;
}

.post-series-title {
  font-weight: bold;
  font-size: 1.1em;
}
.post-series-list {
  padding-left: 1.5em;
  margin: 0;
}
.post-series .current {
  font-style: italic;
}

/* archive pages */
ul.post-list {
  list-style: none;
  padding: 0;
}

.post-post + .post-post {
  margin-top: 2em;
}

.post-title {
  font-size: 1.2em;
}

.post-excerpt p {
  display: inline;
}

.post-date {
  font-style: italic;
  white-space: nowrap;
  float: right;
  margin: 0;
  margin-left: 3em;
  font-size: smaller;
}

.post-list .footnote, .post-list .footnotes, .post-list p:empty {
  display: none
}

.post-list-empty {
    text-align: center;
}

/* media queries */


@media only print {
    a {
      text-decoration: none !important;
    }
    header {
        display:none !important;
    }

    h1, h2, h3, h4 {
        padding-left: 0 !important;
    }

    #wrapper {
       max-width: none !important;
    }

    .no-print {
        display: none !important;
    }

    .footnotes .reversefootnote {
         display: none !important;
    }
    [data-lang]::before {
      content: "";
    }
}

    

    
  </style>
  
</head>

<body>
<div id="wrapper">
  <header>
    <h1 id="blog-title"><a href="/">Huon on the internet</a></h1>
    <nav>
      <ul id="info-list" class="no-print">
        <li><a href="/about">About</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="https://github.com/huonw">GitHub</a></li>
        <li><a href="https://bsky.app/profile/huonw.bsky.social">Bluesky</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <article>
      
        <h1 id="title"> TypeScript strictness is non-monotonic: strict-null-checks and no-implicit-any interact</h1>
        
      
      
         <div id="info-intro">
           By <a href="/about">Huon Wilson</a>
           
             &mdash; <span class="date pub-date">03 Dec 2025</span>
           
           
         </div>
      
      <p>The TypeScript compiler options <code class="language-plaintext highlighter-rouge">strictNullChecks</code> and <code class="language-plaintext highlighter-rouge">noImplicitAny</code> interact in a strange way: enabling just <code class="language-plaintext highlighter-rouge">strictNullChecks</code> leads to type errors that disappear after enabling <code class="language-plaintext highlighter-rouge">noImplicitAny</code> too, meaning getting stricter has fewer errors!</p>

<p>This is a low-consequence curiosity, but I did trip over it in the real world, while updating some modules at work to be stricter.</p>

<h2 id="the-context">The context</h2>

<p>TypeScript is a powerful tool for taming a JavaScript codebase, but getting the most assurance requires using it in “strict” mode.</p>

<p>Adopting TypeScript in an existing JavaScript codebase can be done incrementally by turning on each of the strict sub-settings, and working through the errors, one-by-one. The incremental approach makes the adoption feasible: don’t fix the <em>whole world</em> in one big bang, make several smaller changes until, finally, the world is fixed.</p>

<p>At work, we’ve recently been ratcheting up our strictness incrementally in this manner, and I came across this interaction.</p>

<h2 id="the-example">The example</h2>

<p>What’s the type of <code class="language-plaintext highlighter-rouge">array</code> in this code snippet?</p>

<figure class="highlight"><pre><code class="language-typescript" data-lang="typescript"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nx">array</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="mi">123</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></figure>

<details>
  <summary>
As a standalone snippet, it looks weird and pointless ("why not <code>const array = [123];</code>?"), but it's the minimal version of real-world code (click for example).
</summary>

  <figure class="highlight"><pre><code class="language-typescript" data-lang="typescript"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="kd">const</span> <span class="nx">featureFlags</span> <span class="o">=</span> <span class="p">[];</span>

<span class="k">if </span><span class="p">(</span><span class="nf">enableRocket</span><span class="p">())</span> <span class="p">{</span>
  <span class="nx">featureFlags</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="dl">"</span><span class="s2">rocket</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if </span><span class="p">(</span><span class="nf">enableParachute</span><span class="p">())</span> <span class="p">{</span>
  <span class="nx">featureFlags</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="dl">"</span><span class="s2">parachute</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="nf">prepareForLandSpeedRecord</span><span class="p">(</span><span class="nx">featureFlags</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></figure>

</details>

<p>There’s no explicit annotation, so TypeScript needs to infer it. The inference is a bit fancy, because it requires “time-travel”: the <code class="language-plaintext highlighter-rouge">const array = []</code> declaration doesn’t say anything about what might be in the array, that only comes from the <code class="language-plaintext highlighter-rouge">push</code> later in the code.</p>

<p>Given all this, it’s not too surprising that the exact inferred type depends on two TypeScript language options:</p>

<div class="table-wrapper">

  <table>
    <thead>
      <tr>
        <th> </th>
        <th><code class="language-plaintext break-all highlighter-rouge">strictNullChecks</code></th>
        <th><code class="language-plaintext break-all highlighter-rouge">noImplicitAny</code></th>
        <th>Inferred type</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>least strict</td>
        <td>❌</td>
        <td>❌</td>
        <td><code class="language-plaintext highlighter-rouge">any[]</code></td>
      </tr>
      <tr>
        <td> </td>
        <td>❌</td>
        <td>✅</td>
        <td><code class="language-plaintext highlighter-rouge">number[]</code></td>
      </tr>
      <tr>
        <td> </td>
        <td>✅</td>
        <td>❌</td>
        <td><code class="language-plaintext highlighter-rouge">never[]</code></td>
      </tr>
      <tr>
        <td>most strict</td>
        <td>✅</td>
        <td>✅</td>
        <td><code class="language-plaintext highlighter-rouge">number[]</code></td>
      </tr>
    </tbody>
  </table>

</div>

<h2 id="the-options">The options</h2>

<p>The two options that are influencing the inferred type here are:</p>

<ul>
  <li><a href="https://www.typescriptlang.org/tsconfig/#strictNullChecks"><code class="language-plaintext highlighter-rouge">strictNullChecks</code></a>: properly enforce handling of optional/nullable values. For instance, when enabled, a nullable string variable (type <code class="language-plaintext highlighter-rouge">string | null</code>) can’t be used directly where a plain <code class="language-plaintext highlighter-rouge">string</code> value is expected.</li>
  <li><a href="https://www.typescriptlang.org/tsconfig/#noImplicitAny"><code class="language-plaintext highlighter-rouge">noImplicitAny</code></a>: avoid inferring the “catch-all” <code class="language-plaintext highlighter-rouge">any</code> type in some ambiguous cases.</li>
</ul>

<p>It’s best to have them both enabled: <code class="language-plaintext highlighter-rouge">strictNullChecks</code> solves the <a href="https://en.wikipedia.org/wiki/Null_pointer#History">“billion dollar mistake”</a>, and <code class="language-plaintext highlighter-rouge">noImplicitAny</code> reduces the number of error-prone <code class="language-plaintext highlighter-rouge">any</code>s that infect the codebase.</p>

<h2 id="the-problem">The problem</h2>

<p>The third configuration in our table above, with <code class="language-plaintext highlighter-rouge">strictNullChecks</code> enabled and <code class="language-plaintext highlighter-rouge">noImplicitAny</code> disabled, infers <code class="language-plaintext highlighter-rouge">array: never[]</code>. The code snippet is thus invalid and is rejected with an error (<a href="https://www.typescriptlang.org/play/?strict=false&amp;noImplicitAny=false&amp;strictFunctionTypes=false&amp;strictPropertyInitialization=false&amp;strictBindCallApply=false&amp;noImplicitThis=false&amp;noImplicitReturns=false&amp;alwaysStrict=false&amp;esModuleInterop=false&amp;declaration=false&amp;noErrorTruncation=true&amp;noImplicitOverride=false&amp;ts=5.9.3#code/GYVwdgxgLglg9mABMAFASkQbwFCL4gegMRQDkAhAOkRiQENlxp4kAjAUwjpAGd3EGUOAAcAtABt2AN3bjEUugCcYdVpMQATTuKV1YCGj0Q9xMAOYALKOICex4ZxXi02XPggIeUAYsV07ALyIANoAugDcbnhKfjaUwrwWKACMAEwAzGiRAL5AA">live example</a>):</p>

<figure class="highlight"><pre><code class="language-typescript" data-lang="typescript"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="nx">array</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="mi">123</span><span class="p">);</span>
<span class="c1">//         ^^^ error: Argument of type '123' is not assignable to parameter of type 'never'.</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Nothing (not the <code class="language-plaintext highlighter-rouge">123</code> literal, nor any other <code class="language-plaintext highlighter-rouge">number</code>, nor anything else) is a “subtype” of <code class="language-plaintext highlighter-rouge">never</code>, and so, yes, it makes sense that this code is invalid.</p>

<h2 id="the-strangeness">The strangeness</h2>

<p>“Enable some stricter requirements, and get an error” is not surprising and not noteworthy… but let’s look closely at the table again:</p>

<div class="table-wrapper">

  <table>
    <thead>
      <tr>
        <th> </th>
        <th><code class="language-plaintext break-all highlighter-rouge">strictNullChecks</code></th>
        <th><code class="language-plaintext break-all highlighter-rouge">noImplicitAny</code></th>
        <th>Inferred type</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>least strict</td>
        <td>❌</td>
        <td>❌</td>
        <td><code class="language-plaintext highlighter-rouge">any[]</code></td>
      </tr>
      <tr>
        <td> </td>
        <td>❌</td>
        <td>✅</td>
        <td><code class="language-plaintext highlighter-rouge">number[]</code></td>
      </tr>
      <tr>
        <td><strong>error!</strong></td>
        <td>✅</td>
        <td>❌</td>
        <td><strong><code class="language-plaintext highlighter-rouge">never[]</code></strong></td>
      </tr>
      <tr>
        <td>most strict</td>
        <td>✅</td>
        <td>✅</td>
        <td><code class="language-plaintext highlighter-rouge">number[]</code></td>
      </tr>
    </tbody>
  </table>

</div>

<p>So, if we’re starting with a lax codebase, and looking to make it strict, we might:</p>

<ol>
  <li>enable <code class="language-plaintext highlighter-rouge">strictNullChecks</code>, and hit a new error (no surprise), then</li>
  <li><strong>resolve this error</strong> without code changes, just by enabling <code class="language-plaintext highlighter-rouge">noImplicitAny</code> (surprise!).</li>
</ol>

<p>As we’re going towards fully strict, enabling strictness options one-by-one can make some “spurious” errors appear transiently, just in the intermediate semi-strict state. The number of errors goes up and then down as we turn on settings!</p>

<p>I’d personally expect enabling strict options to be monotonic: more options enabled = more errors emitted. This pair of options violates that expectation.</p>

<h2 id="the-solution">The solution</h2>

<p>There’s a few ways to “solve” this weirdness when trying to make a TypeScript codebase strict:</p>

<ol>
  <li>Just fix the errors with explicit annotations like <code class="language-plaintext highlighter-rouge">const array: number[] = []</code>.</li>
  <li>Use a different one-by-one order: enable <code class="language-plaintext highlighter-rouge">noImplicitAny</code> first and then <code class="language-plaintext highlighter-rouge">strictNullChecks</code>. As the table shows, the inference gives <code class="language-plaintext highlighter-rouge">array: number[]</code> for both steps in this order, and thus there’s no error.</li>
  <li>Enable them together: instead of trying to be fully incremental, just enable these two options in one step.</li>
</ol>

<h2 id="the-explanation">The explanation</h2>

<p>Why does having <code class="language-plaintext highlighter-rouge">strictNullChecks</code> enabled and <code class="language-plaintext highlighter-rouge">noImplicitAny</code> disabled lead to an error that doesn’t appear elsewhere? <a href="https://stackoverflow.com/a/72660888">jcalz explains it well on StackOverflow</a>, with the core being:</p>

<ul>
  <li>This problematic combination is an edge-case which was left for <strong>backwards compatibility</strong>, where <code class="language-plaintext highlighter-rouge">array</code>’s type is inferred as <code class="language-plaintext highlighter-rouge">never[]</code> at its declaration and that’s locked in for the rest of the code.</li>
  <li>Enabling <code class="language-plaintext highlighter-rouge">noImplicitAny</code> has the compiler use “evolving” types in ambiguous locations (places where <code class="language-plaintext highlighter-rouge">any</code> would be inferred, without <code class="language-plaintext highlighter-rouge">noImplicitAny</code>): thus, <code class="language-plaintext highlighter-rouge">array</code>’s type is <em>not</em> confirmed on the line of its declaration and can incorporate the information from the <code class="language-plaintext highlighter-rouge">push</code> for inference.</li>
</ul>

<h2 id="the-editorialising">The editorialising</h2>

<p>This feels like a cute brainteaser, rather than a major issue:</p>

<ul>
  <li>It’s not a major imposition or significant waste of time to fix the spurious errors, and arguably having the annotation may make this sort of code clearer.</li>
  <li>It’s understandable that the semi-strict state might have weird behaviour: I imagine the TypeScript developers are more interested in a good experience with full strictness, as hopefully the intermediate states are just stepping stones, rather than a long-term situation.</li>
</ul>

<h2 id="the-summary">The summary</h2>

<p>The <code class="language-plaintext highlighter-rouge">strictNullChecks</code> and <code class="language-plaintext highlighter-rouge">noImplicitAny</code> TypeScript options interact in a curious way: enabling them one-by-one in the “wrong” order leads to errors that appear and then disappear, violating the expectation of monotonicity (stricter options enabled = more errors). This can occur in real code, but has minimal impact, as it’s easy to resolve and/or side-step.</p>

<section id="external-links" class="no-print">
  
  <div id="external-page">
    <span class="external-label">Share this on</span>
    <ul class="external-list">
      <li class="external-link"><a href="https://bsky.app/intent/compose?text=TypeScript%20strictness%20is%20non-monotonic:%20strict-null-checks%20and%20no-implicit-any%20interact%20by%20@huonw.bsky.social%20https://huonw.github.io/blog/2025/12/typescript-monotonic/" target="_blank" rel="nofollow noopener" title="Share on Bluesky">Bluesky</a></li>
      <li class="external-link"><a href="https://twitter.com/intent/tweet?text=TypeScript%20strictness%20is%20non-monotonic:%20strict-null-checks%20and%20no-implicit-any%20interact%20%23rustlang&amp;url=https://huonw.github.io/blog/2025/12/typescript-monotonic/&amp;via=huon_w" target="_blank" rel="nofollow noopener" title="Share on Twitter">Twitter</a></li>
      <li class="external-link"><a href="https://facebook.com/sharer.php?u=https://huonw.github.io/blog/2025/12/typescript-monotonic/" rel="nofollow noopener" target="_blank" title="Share on Facebook">Facebook</a></li>
      <li class="external-link"><a href="https://www.reddit.com/submit?url=https://huonw.github.io/blog/2025/12/typescript-monotonic/&amp;title=TypeScript%20strictness%20is%20non-monotonic:%20strict-null-checks%20and%20no-implicit-any%20interact" rel="nofollow noopener" target="_blank" title="Share on Reddit">Reddit</a></li>
    </ul>
  </div>
</section>


    </article>

    
    <div id="no-ai">This article is from a human: I used no AI to write it.</div>
    <footer id="more" class="no-print">
      <div id="by-line">
  <a href="/about"><div class="no-print" id="me-icon"></div></a>

<p>I'm <a href="https://bsky.app/profile/huonw.bsky.social"><strong>Huon Wilson</strong></a>, a
 mathematically and statistically inclined software engineer.
 I have been a long-term volunteer
 on <a href="http://rust-lang.org">Rust</a>'s core team, a
 compiler engineer on the <a href="https://swift.org/">Swift</a> team
 at Apple, and a senior software engineer at CSIRO's Data61, working on the <a href="https://github.com/stellargraph/stellargraph">StellarGraph
 graph machine learning library</a>.
</p>
</div>
      <h2 id="latest-heading"><a href="/blog">Latest posts</a></h2>
      
      <nav>
        <ul id="latest-list"><!--
           
           --><li class="latest-post">
                <a href="/blog/2025/12/magit-insert-worktrees/">
                   <h3>magit-insert-worktrees improves status buffers</h3>
                     <p>When using Emacs’ Magit and Git worktrees, adding the magit-insert-worktrees section inserter gives an nice overview of them in the status buffer.
</p>
                   
                 </a>
            </li><!--
          
           --><li class="latest-post">
                <a href="/blog/2025/11/piraite/">
                   <h3>Context privateering: debugging custom instructions like a pirate</h3>
                     <p>Adding “always speak like a pirate” to instructions for an AI tool is a helpful generic trick for debugging whether those instructions are being read correctly.
</p>
                   
                 </a>
            </li><!--
          
           --><li class="latest-post">
                <a href="/blog/2025/09/deprecating-vs-removing/">
                   <h3>Is that a deprecation? Or is it just removed?</h3>
                     <p>It’s useful to have a specific label for “make changes that discourage use of some code”, different to “remove the code”.
</p>
                   
                 </a>
            </li><!--
          
      --></ul>
      </nav>
    </footer>
    
  </main>

  <footer id="page-footer">
    <span>Huon Wilson &mdash; <span class="date">2026</span></span>
  </footer>
</div>



<!-- Default Statcounter code for huonw.github.io
http://huonw.github.io -->
<script type="text/javascript">
var sc_project=7439209;
var sc_invisible=1;
var sc_security="b96244c7";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="hit counter"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/7439209/0/b96244c7/1/"
alt="hit counter"
referrerPolicy="no-referrer-when-downgrade"></a></div></noscript>
<!-- End of Statcounter Code -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-62534856-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-62534856-1');
</script>



</body> </html>
